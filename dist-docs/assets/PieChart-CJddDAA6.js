import{e as W,l as h,c as i,o as r,g as w,k as D,a as n,F as N,b as A,n as k,t as v,E as H}from"./index-GxWqBnN7.js";const Z={class:"ui-surface w-full h-full relative"},q={key:0,class:"ui-surface w-full h-full flex items-center justify-center"},G=["width","height","viewBox"],J=["d","fill","stroke","stroke-width","onMouseenter","onClick"],K=["cx","cy","r","fill"],O={key:1},Q=["x","y"],U=["x","y"],ee={key:2},te=["x","y"],le={key:3},ae=["transform"],se=["fill"],oe={class:"ui-surface ui-text px-4 py-3 rounded-lg shadow-2xl border ui-border-strong min-w-[180px]"},ne={class:"flex items-center gap-2 mb-1.5"},ie={class:"font-semibold text-sm"},re={class:"flex items-baseline gap-2 ml-5"},ue={class:"text-2xl font-bold"},de={class:"mt-1 ml-5"},ce={class:"text-xs ui-text"},fe={__name:"PieChart",props:{data:{type:Array,required:!0},labels:{type:Array,default:()=>[]},colors:{type:Array,default:()=>["#3b82f6","#ef4444","#10b981","#f59e0b","#8b5cf6","#ec4899","#14b8a6","#f97316"]},width:{type:Number,default:400},height:{type:Number,default:300},doughnut:{type:Boolean,default:!1},innerRadiusRatio:{type:Number,default:.6},showValues:{type:Boolean,default:!0},showPercentages:{type:Boolean,default:!0},showLegend:{type:Boolean,default:!0},showCenterText:{type:Boolean,default:!0},legendPosition:{type:String,default:"bottom",validator:o=>["bottom","right"].includes(o)},strokeColor:{type:String,default:"#ffffff"},strokeWidth:{type:Number,default:2},centerFill:{type:String,default:"#ffffff"},sliceClasses:{type:String,default:"transition-all duration-200 hover:opacity-80 cursor-pointer"},valueLabelClasses:{type:String,default:"fill-(--ui-surface) text-sm font-bold drop-shadow-md"},centerTextClasses:{type:String,default:"fill-(--ui-text) text-2xl font-bold"},centerLabelClasses:{type:String,default:"fill-(--ui-text) text-sm"},legendTextClasses:{type:String,default:"fill-(--ui-text) text-xs font-medium"}},emits:["slice-click","slice-hover"],setup(o,{emit:z}){const l=o,T=z,d=W({visible:!1,x:0,y:0,label:"",value:0,percentage:"0",color:""}),M=h(()=>l.data.reduce((t,e)=>t+(e||0),0)||0),F=h(()=>l.data.length>0&&M.value>0),m=h(()=>l.showLegend&&l.legendPosition==="right"?l.width/3:l.width/2),b=h(()=>{const a=l.showLegend&&l.legendPosition==="bottom"?Math.ceil(l.data.length/2)*25:0;return(l.height-a)/2}),$=h(()=>{const a=l.showLegend&&l.legendPosition==="bottom"?Math.ceil(l.data.length/2)*25:0,t=l.height-a,e=l.showLegend&&l.legendPosition==="right"?l.width*.6:l.width;return Math.min(e,t)/2-40}),C=h(()=>l.doughnut?$.value*l.innerRadiusRatio:0),P=h(()=>{if(!F.value)return[];const a=M.value;let t=-Math.PI/2;return l.data.map((e,s)=>{const u=e||0,c=(u/a*100).toFixed(1),x=u/a*2*Math.PI,f=t+x,p=I(m.value,b.value,$.value,C.value,t,f),y=l.doughnut?($.value+C.value)/2:$.value*.7,g=t+x/2,S=m.value+Math.cos(g)*y,B=b.value+Math.sin(g)*y,V={value:u,percentage:c,path:p,labelX:S,labelY:B,label:l.labels[s]||`Item ${s+1}`,startAngle:t,endAngle:f};return t=f,V}).filter(e=>e.value>0)}),I=(a,t,e,s,u,c)=>{const x=a+e*Math.cos(u),f=t+e*Math.sin(u),p=a+e*Math.cos(c),y=t+e*Math.sin(c),g=c-u>Math.PI?1:0;if(s===0)return`M ${a} ${t} L ${x} ${f} A ${e} ${e} 0 ${g} 1 ${p} ${y} Z`;{const S=a+s*Math.cos(c),B=t+s*Math.sin(c),V=a+s*Math.cos(u),j=t+s*Math.sin(u);return`M ${x} ${f} A ${e} ${e} 0 ${g} 1 ${p} ${y} L ${S} ${B} A ${s} ${s} 0 ${g} 0 ${V} ${j} Z`}},L=a=>l.colors[a%l.colors.length],X=a=>{if(l.legendPosition==="right")return l.width*.65;const e=a%2;return l.width/4+e*(l.width/2)},Y=a=>{if(l.legendPosition==="right")return 40+a*25;const e=Math.floor(a/2),s=Math.ceil(l.data.length/2)*25;return l.height-s+20+e*25},E=(a,t,e)=>{d.value={visible:!0,x:a.clientX,y:a.clientY,label:t.label,value:t.value,percentage:t.percentage,color:L(e)},T("slice-hover",{value:t.value,index:e,label:t.label,percentage:t.percentage})},R=()=>{d.value.visible=!1},_=(a,t)=>{T("slice-click",{value:a.value,index:t,label:a.label,percentage:a.percentage})};return(a,t)=>(r(),i("div",Z,[F.value?(r(),i("svg",{key:1,width:o.width,height:o.height,viewBox:`0 0 ${o.width} ${o.height}`,class:"overflow-visible"},[n("g",null,[(r(!0),i(N,null,A(P.value,(e,s)=>(r(),i("path",{key:`slice-${s}`,d:e.path,fill:L(s),stroke:o.strokeColor,"stroke-width":o.strokeWidth,class:k(o.sliceClasses),onMouseenter:u=>E(u,e,s),onMouseleave:R,onClick:u=>_(e,s)},null,42,J))),128))]),o.doughnut?(r(),i("circle",{key:0,cx:m.value,cy:b.value,r:C.value,fill:o.centerFill},null,8,K)):w("",!0),o.doughnut&&o.showCenterText?(r(),i("g",O,[n("text",{x:m.value,y:b.value-5,class:k(o.centerTextClasses),"text-anchor":"middle","dominant-baseline":"middle"},v(M.value),11,Q),n("text",{x:m.value,y:b.value+15,class:k(o.centerLabelClasses),"text-anchor":"middle","dominant-baseline":"middle"}," Total ",10,U)])):w("",!0),o.showValues?(r(),i("g",ee,[(r(!0),i(N,null,A(P.value,(e,s)=>(r(),i("text",{key:`value-${s}`,x:e.labelX,y:e.labelY,class:k(o.valueLabelClasses),"text-anchor":"middle","dominant-baseline":"middle"},v(o.showPercentages?`${e.percentage}%`:e.value),11,te))),128))])):w("",!0),o.showLegend?(r(),i("g",le,[(r(!0),i(N,null,A(P.value,(e,s)=>(r(),i("g",{key:`legend-${s}`,transform:`translate(${X(s)}, ${Y(s)})`},[n("rect",{width:12,height:12,fill:L(s),rx:"2"},null,8,se),n("text",{x:18,y:10,class:k(o.legendTextClasses)},v(e.label),3)],8,ae))),128))])):w("",!0)],8,G)):(r(),i("div",q,[...t[0]||(t[0]=[D('<div class="text-center"><div class="ui-text mb-2"><svg class="w-16 h-16 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 3.055A9.001 9.001 0 1020.945 13H11V3.055z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.488 9H15V3.512A9.025 9.025 0 0120.488 9z"></path></svg></div><p class="text-sm ui-text"> No data available </p></div>',1)])])),d.value.visible?(r(),i("div",{key:2,style:H({position:"fixed",left:`${d.value.x}px`,top:`${d.value.y}px`,transform:"translate(-50%, -120%)",pointerEvents:"none",zIndex:9999}),class:"animate-in fade-in duration-200"},[n("div",oe,[n("div",ne,[n("div",{style:H({backgroundColor:d.value.color}),class:"w-3 h-3 rounded-full shadow-sm"},null,4),n("p",ie,v(d.value.label),1)]),n("div",re,[n("span",ue,v(d.value.value),1),t[1]||(t[1]=n("span",{class:"text-xs ui-text"},"tasks",-1))]),n("div",de,[n("span",ce,v(d.value.percentage)+"% of total",1)]),t[2]||(t[2]=n("div",{class:"absolute bottom-0 left-1/2 transform -translate-x-1/2 translate-y-1/2 rotate-45 w-2 h-2 ui-surface border-r border-b ui-border-strong"},null,-1))])],4)):w("",!0)]))}};export{fe as default};
