import{e as F,l as g,c as s,o as i,g as b,a as r,F as f,b as m,n as p,t as y,E as X}from"./index-GxWqBnN7.js";const H={class:"w-full h-full relative"},j=["width","height","viewBox"],q={key:0},D=["x1","y1","x2","y2","stroke"],O=["id"],U=["stop-color"],J=["stop-color"],P=["x","y","width","height","fill","onMouseenter","onClick"],Q=["to","begin"],R=["from","to","begin"],Z={key:1},I=["x","y"],_={key:2},tt=["x","y"],et={key:3},lt=["x","y"],at={key:4},ot=["x","y"],st=["x1","y1","x2","y2"],it=["x1","y1","x2","y2"],nt={class:"ui-surface ui-text px-4 py-3 rounded-lg shadow-2xl border ui-border-strong min-w-[180px]"},rt={class:"flex items-center gap-2 mb-2"},ut={class:"font-semibold text-sm"},dt={class:"ml-5"},ct={class:"text-xs ui-text mb-1"},ht={class:"text-2xl font-bold"},yt={__name:"StackedBarChart",props:{data:{type:Array,required:!0},labels:{type:Array,default:()=>[]},colors:{type:Array,default:()=>["#f97316","#10b981"]},groupKeys:{type:Array,default:()=>["complied","uncomplied"]},width:{type:Number,default:400},height:{type:Number,default:300},padding:{type:Object,default:()=>({top:20,right:20,bottom:60,left:60})},showGrid:{type:Boolean,default:!0},showXAxis:{type:Boolean,default:!0},showYAxis:{type:Boolean,default:!0},gridColor:{type:String,default:"#e5e7eb"},barClasses:{type:String,default:"transition-all duration-200 hover:opacity-90 cursor-pointer"},axisLabelClasses:{type:String,default:"fill-(--ui-text) text-xs font-medium"},maxValue:{type:Number,default:100},xAxisLabel:{type:String,default:""},yAxisLabel:{type:String,default:""}},emits:["bar-click","bar-hover"],setup(t,{emit:G}){const a=t,$=G,c=F({visible:!1,x:0,y:0,label:"",barLabel:"",value:0,color:""}),h=g(()=>a.height-a.padding.top-a.padding.bottom),v=g(()=>a.width-a.padding.left-a.padding.right),k=g(()=>v.value/a.data.length*.8),A=g(()=>v.value/a.data.length*.2),C=g(()=>k.value/a.groupKeys.length),K=g(()=>0),L=g(()=>{const e=[];for(let l=0;l<=5;l++){const o=a.padding.top+h.value/5*l;e.push(o)}return e}),B=e=>a.padding.left+e*(k.value+A.value)+A.value/2,M=(e,n)=>B(e)+n*(C.value+K.value),S=e=>{const n=h.value/a.maxValue;return a.padding.top+h.value-e*n},N=e=>{const n=h.value/a.maxValue;return e*n},w=e=>a.colors[e%a.colors.length],V=e=>{const n=(a.height-a.padding.bottom-e)/h.value*a.maxValue;return Math.round(n)},z=e=>e.charAt(0).toUpperCase()+e.slice(1),Y=(e,n,l)=>{const o=a.data[n],d=a.groupKeys[l],u=o[d]||0,x=a.labels[n]||`Item ${n+1}`,W=z(d);c.value={visible:!0,x:e.clientX,y:e.clientY,label:x,barLabel:W,value:u,color:w(l)},$("bar-hover",{dataIndex:n,barIndex:l,key:d,value:u,label:x})},E=()=>{c.value.visible=!1},T=(e,n)=>{const l=a.data[e],o=a.groupKeys[n],d=l[o]||0,u=a.labels[e]||`Item ${e+1}`;$("bar-click",{dataIndex:e,barIndex:n,key:o,value:d,label:u})};return(e,n)=>(i(),s("div",H,[(i(),s("svg",{width:t.width,height:t.height,viewBox:`0 0 ${t.width} ${t.height}`,class:"overflow-visible"},[t.showGrid?(i(),s("g",q,[(i(!0),s(f,null,m(L.value,l=>(i(),s("line",{key:`grid-${l}`,x1:t.padding.left,y1:l,x2:t.width-t.padding.right,y2:l,stroke:t.gridColor,"stroke-width":"1","stroke-dasharray":"4,4",opacity:"0.3"},null,8,D))),128))])):b("",!0),r("defs",null,[(i(!0),s(f,null,m(t.groupKeys,(l,o)=>(i(),s("linearGradient",{id:`barGradient-${o}`,key:`gradient-${o}`,x1:"0%",y1:"0%",x2:"0%",y2:"100%"},[r("stop",{offset:"0%","stop-color":w(o),"stop-opacity":"0.95"},null,8,U),r("stop",{offset:"100%","stop-color":w(o),"stop-opacity":"0.85"},null,8,J)],8,O))),128))]),r("g",null,[(i(!0),s(f,null,m(t.data,(l,o)=>(i(),s("g",{key:`bar-group-${o}`},[(i(!0),s(f,null,m(t.groupKeys,(d,u)=>(i(),s("rect",{key:`bar-${o}-${u}`,x:M(o,u),y:S(l[d]||0),width:C.value,height:N(l[d]||0),fill:`url(#barGradient-${u})`,class:p(t.barClasses),rx:"4",onMouseenter:x=>Y(x,o,u),onMouseleave:E,onClick:x=>T(o,u)},[r("animate",{attributeName:"height",from:0,to:N(l[d]||0),dur:"0.6s",begin:`${u*.1}s`,fill:"freeze"},null,8,Q),r("animate",{attributeName:"y",from:t.padding.top+h.value,to:S(l[d]||0),dur:"0.6s",begin:`${u*.1}s`,fill:"freeze"},null,8,R)],42,P))),128))]))),128))]),t.showXAxis?(i(),s("g",Z,[(i(!0),s(f,null,m(t.labels,(l,o)=>(i(),s("text",{key:`xlabel-${o}`,x:B(o)+k.value/2,y:t.height-t.padding.bottom+20,class:p(t.axisLabelClasses),"text-anchor":"middle"},y(l),11,I))),128))])):b("",!0),t.xAxisLabel?(i(),s("g",_,[r("text",{x:t.padding.left+v.value/2,y:t.height-10,class:"fill-(--ui-text) text-sm font-semibold","text-anchor":"middle"},y(t.xAxisLabel),9,tt)])):b("",!0),t.showYAxis?(i(),s("g",et,[(i(!0),s(f,null,m(L.value,l=>(i(),s("text",{key:`ylabel-${l}`,x:t.padding.left-10,y:l+4,class:p(t.axisLabelClasses),"text-anchor":"end"},y(V(l)),11,lt))),128))])):b("",!0),t.yAxisLabel?(i(),s("g",at,[r("text",{x:-(t.padding.top+h.value/2),y:t.padding.left-40,class:"fill-(--ui-text) text-sm font-semibold","text-anchor":"middle",transform:"rotate(-90)"},y(t.yAxisLabel),9,ot)])):b("",!0),r("line",{x1:t.padding.left,y1:t.padding.top,x2:t.padding.left,y2:t.height-t.padding.bottom,stroke:"#cbd5e1","stroke-width":"2"},null,8,st),r("line",{x1:t.padding.left,y1:t.height-t.padding.bottom,x2:t.width-t.padding.right,y2:t.height-t.padding.bottom,stroke:"#cbd5e1","stroke-width":"2"},null,8,it)],8,j)),c.value.visible?(i(),s("div",{key:0,style:X({position:"fixed",left:`${c.value.x}px`,top:`${c.value.y}px`,transform:"translate(-50%, -120%)",pointerEvents:"none",zIndex:9999}),class:"animate-in fade-in duration-200"},[r("div",nt,[r("div",rt,[r("div",{style:X({backgroundColor:c.value.color}),class:"w-3 h-3 rounded shadow-sm"},null,4),r("p",ut,y(c.value.label),1)]),r("div",dt,[r("p",ct,y(c.value.barLabel),1),r("span",ht,y(c.value.value)+"%",1)]),n[0]||(n[0]=r("div",{class:"absolute bottom-0 left-1/2 transform -translate-x-1/2 translate-y-1/2 rotate-45 w-2 h-2 ui-surface border-r border-b ui-border-strong"},null,-1))])],4)):b("",!0)]))}};export{yt as default};
